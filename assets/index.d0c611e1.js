var ot=Object.defineProperty;var Z=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var ae=(t,e,o)=>e in t?ot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,re=(t,e)=>{for(var o in e||(e={}))Ee.call(e,o)&&ae(t,o,e[o]);if(Z)for(var o of Z(e))xe.call(e,o)&&ae(t,o,e[o]);return t};var se=(t,e)=>{var o={};for(var r in t)Ee.call(t,r)&&e.indexOf(r)<0&&(o[r]=t[r]);if(t!=null&&Z)for(var r of Z(t))e.indexOf(r)<0&&xe.call(t,r)&&(o[r]=t[r]);return o};var Oe=(t,e,o)=>(ae(t,typeof e!="symbol"?e+"":e,o),o);import{E as c,T as k,R as O,r as W,o as at,w as ke,a as rt,b as st,d as R,N as _,c as Ce,p as K,e as ee,i as ie,f as X,P as q,g as S,h as it,F as le,j as lt,k as ve,m as Fe,l as ct,n as te,t as dt,s as ft,q as ut,u as pt,v as gt,x as ht,y as mt,z as wt,A as Dt}from"./vendor.51cf298a.js";const yt=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}};yt();let bt=0;class St{constructor(){Oe(this,"id");this.id=`${bt++}`}}const ce=new WeakMap,de=new WeakMap,Be=new WeakMap,fe=new WeakMap,ne=new WeakMap,J=new WeakMap,ue=new WeakMap,oe=new WeakMap,Ne=new WeakMap,H=new WeakMap,pe=new WeakMap,Me=Symbol("placeholder"),ge=t=>t&&t.ownerDocument&&t.ownerDocument.defaultView||null,Et=t=>U(t)&&t.nodeType===8,V=t=>U(t)&&t.nodeType===1,U=t=>{const e=ge(t);return!!e&&t instanceof e.Node},Te=t=>{const e=t&&t.anchorNode&&ge(t.anchorNode);return!!e&&t instanceof e.Selection},Le=t=>U(t)&&t.nodeType===3,xt=t=>t.clipboardData&&t.clipboardData.getData("text/plain")!==""&&t.clipboardData.types.length===1,Ot=t=>{let[e,o]=t;if(V(e)&&e.childNodes.length){let r=o===e.childNodes.length,s=r?o-1:o;for([e,s]=Ie(e,s,r?"backward":"forward"),r=s<o;V(e)&&e.childNodes.length;){const a=r?e.childNodes.length-1:0;e=Ct(e,a,r?"backward":"forward")}o=r&&e.textContent!=null?e.textContent.length:0}return[e,o]},kt=()=>!!(window.document.activeElement&&window.document.activeElement.shadowRoot),Ie=(t,e,o)=>{const{childNodes:r}=t;let s=r[e],a=e,i=!1,f=!1;for(;(Et(s)||V(s)&&s.childNodes.length===0||V(s)&&s.getAttribute("contenteditable")==="false")&&!(i&&f);){if(a>=r.length){i=!0,a=e-1,o="backward";continue}if(a<0){f=!0,a=e+1,o="forward";continue}s=r[a],e=a,a+=o==="forward"?1:-1}return[s,e]},Ct=(t,e,o)=>{const[r]=Ie(t,e,o);return r},Re=t=>{let e="";if(Le(t)&&t.nodeValue)return t.nodeValue;if(V(t)){for(const r of Array.from(t.childNodes))e+=Re(r);const o=getComputedStyle(t).getPropertyValue("display");(o==="block"||o==="list"||t.tagName==="BR")&&(e+=`
`)}return e},vt=/data-slate-fragment="(.+?)"/m,Ft=t=>{const e=t.getData("text/html"),[,o]=e.match(vt)||[];return o},Bt=typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Ae=typeof navigator!="undefined"&&/Mac OS X/.test(navigator.userAgent);typeof navigator!="undefined"&&/Android/.test(navigator.userAgent);const he=typeof navigator!="undefined"&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),me=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Nt=typeof navigator!="undefined"&&/Edge?\/(?:[0-6][0-9]|[0-7][0-8])/i.test(navigator.userAgent),Pe=typeof navigator!="undefined"&&/Chrome/i.test(navigator.userAgent),Mt=typeof navigator!="undefined"&&/Chrome?\/(?:[0-7][0-5]|[0-6][0-9])/i.test(navigator.userAgent),Tt=typeof navigator!="undefined"&&/^(?!.*Seamonkey)(?=.*Firefox\/(?:[0-7][0-9]|[0-8][0-6])).*/i.test(navigator.userAgent),Lt=typeof navigator!="undefined"&&/.*QQBrowser/.test(navigator.userAgent),z=!Mt&&!Nt&&typeof globalThis!="undefined"&&globalThis.InputEvent&&typeof globalThis.InputEvent.prototype.getTargetRanges=="function",d={getWindow(t){const e=Be.get(t);if(!e)throw new Error("Unable to find a host window element for this editor");return e},findKey(t,e){let o=ue.get(e);return o||(o=new St,ue.set(e,o)),o},findPath(t,e){const o=[];let r=e;for(;;){const s=de.get(r);if(s==null){if(c.isEditor(r))return o;break}const a=ce.get(r);if(a==null)break;o.unshift(a),r=s}throw new Error(`Unable to find the path for Slate node: ${JSON.stringify(e)}`)},findDocumentOrShadowRoot(t){const e=d.toDOMNode(t,t),o=e.getRootNode();return(o instanceof Document||o instanceof ShadowRoot)&&o.getSelection!=null?o:e.ownerDocument},isFocused(t){return!!H.get(t)},isReadOnly(t){return!!Ne.get(t)},blur(t){const e=d.toDOMNode(t,t),o=d.findDocumentOrShadowRoot(t);H.set(t,!1),o.activeElement===e&&e.blur()},focus(t){const e=d.toDOMNode(t,t),o=d.findDocumentOrShadowRoot(t);H.set(t,!0),o.activeElement!==e&&e.focus({preventScroll:!0})},deselect(t){d.toDOMNode(t,t);const{selection:e}=t,r=d.findDocumentOrShadowRoot(t).getSelection();r&&r.rangeCount>0&&r.removeAllRanges(),e&&k.deselect(t)},hasDOMNode(t,e,o={}){const{editable:r=!1}=o,s=d.toDOMNode(t,t);let a;try{a=V(e)?e:e.parentElement}catch(i){if(!i.message.includes('Permission denied to access property "nodeType"'))throw i}return a?a.closest("[data-slate-editor]")===s&&(!r||a.isContentEditable?!0:typeof a.isContentEditable=="boolean"&&a.closest('[contenteditable="false"]')===s||!!a.getAttribute("data-slate-zero-width")):!1},insertData(t,e){t.insertData(e)},insertFragmentData(t,e){t.insertFragmentData(e)},insertTextData(t,e){t.insertTextData(e)},setFragmentData(t,e){t.setFragmentData(e)},toDOMNode(t,e){const o=oe.get(t),r=c.isEditor(e)?fe.get(t):o==null?void 0:o.get(d.findKey(t,e));if(!r)throw new Error(`Cannot resolve a DOM node from Slate node: ${JSON.stringify(e)}`);return r},toDOMPoint(t,e){const[o]=c.node(t,e.path),r=d.toDOMNode(t,o);let s;c.void(t,{at:e})&&(e={path:e.path,offset:0});const a="[data-slate-string], [data-slate-zero-width]",i=Array.from(r.querySelectorAll(a));let f=0;for(const p of i){const u=p.childNodes[0];if(u==null||u.textContent==null)continue;const{length:D}=u.textContent,n=p.getAttribute("data-slate-length"),h=n==null?D:parseInt(n,10),b=f+h;if(e.offset<=b){const g=Math.min(D,Math.max(0,e.offset-f));s=[u,g];break}f=b}if(!s)throw new Error(`Cannot resolve a DOM point from Slate point: ${JSON.stringify(e)}`);return s},toDOMRange(t,e){const{anchor:o,focus:r}=e,s=O.isBackward(e),a=d.toDOMPoint(t,o),i=O.isCollapsed(e)?a:d.toDOMPoint(t,r),p=d.getWindow(t).document.createRange(),[u,D]=s?i:a,[n,h]=s?a:i,g=!!(V(u)?u:u.parentElement).getAttribute("data-slate-zero-width"),E=!!(V(n)?n:n.parentElement).getAttribute("data-slate-zero-width");return p.setStart(u,g?1:D),p.setEnd(n,E?1:h),p},toSlateNode(t,e){let o=V(e)?e:e.parentElement;o&&!o.hasAttribute("data-slate-node")&&(o=o.closest("[data-slate-node]"));const r=o?ne.get(o):null;if(!r)throw new Error(`Cannot resolve a Slate node from DOM node: ${o}`);return r},findEventRange(t,e){"nativeEvent"in e&&(e=e.nativeEvent);const{clientX:o,clientY:r,target:s}=e;if(o==null||r==null)throw new Error(`Cannot resolve a Slate range from a DOM event: ${e}`);const a=d.toSlateNode(t,e.target),i=d.findPath(t,a);if(c.isVoid(t,a)){const D=s.getBoundingClientRect(),n=t.isInline(a)?o-D.left<D.left+D.width-o:r-D.top<D.top+D.height-r,h=c.point(t,i,{edge:n?"start":"end"}),b=n?c.before(t,h):c.after(t,h);if(b)return c.range(t,b)}let f;const{document:p}=window;if(p.caretRangeFromPoint)f=p.caretRangeFromPoint(o,r);else{const D=p.caretPositionFromPoint(o,r);D&&(f=p.createRange(),f.setStart(D.offsetNode,D.offset),f.setEnd(D.offsetNode,D.offset))}if(!f)throw new Error(`Cannot resolve a Slate range from a DOM event: ${e}`);return d.toSlateRange(t,f,{exactMatch:!1,suppressThrow:!1})},toSlatePoint(t,e,o){var h;const{exactMatch:r,suppressThrow:s}=o,[a,i]=r?e:Ot(e),f=a.parentNode;let p=null,u=0;if(f){const b=f.closest('[data-slate-void="true"]');let g=f.closest("[data-slate-leaf]"),y=null;if(g){p=g.closest('[data-slate-node="text"]');const C=d.getWindow(t).document.createRange();C.setStart(p,0),C.setEnd(a,i);const x=C.cloneContents();[...Array.prototype.slice.call(x.querySelectorAll("[data-slate-zero-width]")),...Array.prototype.slice.call(x.querySelectorAll("[contenteditable=false]"))].forEach(v=>{v.parentNode.removeChild(v)}),u=x.textContent.length,y=p}else b&&(g=b.querySelector("[data-slate-leaf]"),g?(p=g.closest('[data-slate-node="text"]'),y=g,u=y.textContent.length,y.querySelectorAll("[data-slate-zero-width]").forEach(E=>{u-=E.textContent.length})):u=1);y&&u===y.textContent.length&&(f.hasAttribute("data-slate-zero-width")||he&&((h=y.textContent)==null?void 0:h.endsWith(`

`)))&&u--}if(!p){if(s)return null;throw new Error(`Cannot resolve a Slate point from DOM point: ${e}`)}const D=d.toSlateNode(t,p);return{path:d.findPath(t,D),offset:u}},toSlateRange(t,e,o){const{exactMatch:r,suppressThrow:s}=o,a=Te(e)?e.anchorNode:e.startContainer;let i,f,p,u,D;if(a&&(Te(e)?(i=e.anchorNode,f=e.anchorOffset,p=e.focusNode,u=e.focusOffset,Pe&&kt()?D=e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset:D=e.isCollapsed):(i=e.startContainer,f=e.startOffset,p=e.endContainer,u=e.endOffset,D=e.collapsed)),i==null||p==null||f==null||u==null)throw new Error(`Cannot resolve a Slate range from DOM range: ${e}`);const n=d.toSlatePoint(t,[i,f],{exactMatch:r,suppressThrow:s});if(!n)return null;const h=D?n:d.toSlatePoint(t,[p,u],{exactMatch:r,suppressThrow:s});if(!h)return null;let b={anchor:n,focus:h};return O.isExpanded(b)&&O.isForward(b)&&V(p)&&c.void(t,{at:b.focus,mode:"highest"})&&(b=c.unhangRange(t,b,{voids:!0})),b},hasRange(t,e){const{anchor:o,focus:r}=e;return c.hasPath(t,o.path)&&c.hasPath(t,r.path)}},we=t=>{const e=W(typeof t=="function"?t():t);return[e,o=>{e.value=o}]},It=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Y=t=>It?Symbol(t):"[slate-vue]"+t,We=Y("slate"),_e=Y("slateStatic"),Rt=Y("editor_Focused"),Ve=Y("editor_readOnly"),je=Y("editor_Decorate"),$=(t,e)=>{let o=null;at(()=>{const r=t();r&&(o=r)}),Array.isArray(e)?e.length!==0&&ke(e,t):rt(t),st(()=>{o==null||o()})},At={value:Array,editor:{type:Object,required:!0},onChange:Function},Pt=R({name:"Slate",props:At,emits:["change"],setup(t,{emit:e,slots:o}){const[r,s]=we(()=>{const b=t,{editor:u,value:D=[],onChange:n}=b,h=se(b,["editor","value","onChange"]);if(!_.isNodeList(D))throw new Error(`[Slate] value is invalid! Expected a list of elementsbut got: ${JSON.stringify(D)}`);if(!c.isEditor(u))throw new Error(`[Slate] editor is invalid! you passed:${JSON.stringify(u)}`);return u.children=D,Object.assign(u,h),[u]}),[a,i]=we(d.isFocused(t.editor)),f=()=>{var u;e("change",t.editor.children),(u=t.onChange)==null||u.call(t,t.editor.children),s([t.editor])};Ce(()=>{pe.set(t.editor,f)});const p=()=>i(d.isFocused(r.value[0]));return $(()=>(document.addEventListener("focus",p,!0),document.addEventListener("blur",p,!0),()=>{pe.set(t.editor,()=>{}),document.removeEventListener("focus",p,!0),document.removeEventListener("blur",p,!0)}),[]),K(We,r),K(_e,t.editor),K(Rt,a.value),()=>(console.info("%c Slate Rerender ","background: #000;  padding:3px 0px; color: #fff;"),ee(o,"default"))}}),Wt={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",splitBlock:"shift?+enter",undo:"mod+z"},_t={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},Vt={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},F=t=>{const e=Wt[t],o=_t[t],r=Vt[t],s=e&&ie(e),a=o&&ie(o),i=r&&ie(r);return f=>!!(s&&s(f)||Ae&&a&&a(f)||!Ae&&i&&i(f))};var B={isBold:F("bold"),isCompose:F("compose"),isMoveBackward:F("moveBackward"),isMoveForward:F("moveForward"),isDeleteBackward:F("deleteBackward"),isDeleteForward:F("deleteForward"),isDeleteLineBackward:F("deleteLineBackward"),isDeleteLineForward:F("deleteLineForward"),isDeleteWordBackward:F("deleteWordBackward"),isDeleteWordForward:F("deleteWordForward"),isExtendBackward:F("extendBackward"),isExtendForward:F("extendForward"),isExtendLineBackward:F("extendLineBackward"),isExtendLineForward:F("extendLineForward"),isItalic:F("italic"),isMoveLineBackward:F("moveLineBackward"),isMoveLineForward:F("moveLineForward"),isMoveWordBackward:F("moveWordBackward"),isMoveWordForward:F("moveWordForward"),isRedo:F("redo"),isSplitBlock:F("splitBlock"),isTransposeCharacter:F("transposeCharacter"),isUndo:F("undo")};function jt(){return X(We)}const $t=()=>X(je);function Q(){return X(_e)}const zt={isLast:Boolean,leaf:Object,parent:Object,text:Object},$e=R({name:"TextString",props:zt,setup(t){const e=Q();return()=>{const{isLast:o,leaf:r,parent:s,text:a}=t,i=d.findPath(e,a),f=q.parent(i);return e.isVoid(s)?S(De,{length:_.string(s).length},null):r.text===""&&s.children[s.children.length-1]===a&&!e.isInline(s)&&c.string(e,f)===""?S(De,{isLineBreak:!0},null):r.text===""?S(De,null,null):o&&r.text.slice(-1)===`
`?S(ze,{isTrailing:!0,text:r.text},null):S(ze,{text:r.text},null)}}}),ze=R({name:"TextString",props:{text:String,isTrailing:Boolean},setup(t){const e=W(null),o=W(0);return $(()=>{e.value&&e.value.textContent!==t.text&&(o.value+=1)}),()=>S("span",{"data-slate-string":!0,ref:e,key:o.value},[t.text,t.isTrailing?`
`:null])}}),De=R({name:"ZeroWidthString",props:{length:Number,isLineBreak:Boolean},render(){const{length:t=0,isLineBreak:e=!1}=this.$props;return S("span",{"data-slate-zero-width":e?"n":"z","data-slate-length":t},["\uFEFF",e?S("br",null,null):null])}}),Ht={isLast:Boolean,leaf:Object,parent:Object,text:Object},Ut=R({name:"Leaf",props:Ht,setup(t){const e=W(null);return $(()=>{const o=e==null?void 0:e.value,r=document.querySelector('[data-slate-editor="true"]');!o||!r||(r.style.minHeight=`${o.clientHeight}px`)},[()=>t.leaf,e]),it(()=>{document.querySelector('[data-slate-editor="true"]').style.minHeight="auto"}),()=>{const{leaf:o,isLast:r,text:s,parent:a}=t,i={"data-slate-leaf":!0};return console.info("%c Leaf Rerender ","background: green;  padding:3px 0px; color: #fff;"),console.log(o),S(qt,{attributes:i,leaf:o,text:s},{default:()=>[o[Me]?S(le,null,[S(an,{attributes:{"data-slate-placeholder":!0,style:{position:"absolute",pointerEvents:"none",width:"100%",maxWidth:"100%",display:"block",opacity:"0.333",userSelect:"none",textDecoration:"none"},contentEditable:!1,ref:e}},{default:()=>[o.placeholder]}),S($e,{isLast:r,leaf:o,parent:a,text:s},null)]):S($e,{isLast:r,leaf:o,parent:a,text:s},null)]})}}}),Kt={leaf:Object,text:Object,attributes:Object},qt=R({name:"DefaultLeaf",props:Kt,render(){return S("span",this.$props.attributes,[ee(this.$slots,"default")])}}),Jt={decorations:Array,isLast:Boolean,parent:Object,text:Object},He=R({name:"Text",props:Jt,setup(t){const e=Q(),o=W(null);return $(()=>{const{text:r}=t,s=d.findKey(e,r),a=oe.get(e);o.value?(a==null||a.set(s,o.value),J.set(r,o.value),ne.set(o.value,r)):(a==null||a.delete(s),J.delete(r))}),()=>{const{decorations:r,isLast:s,parent:a,text:i}=t,f=lt.decorations(i,r),p=d.findKey(e,i);return console.info("%c Text Rerender ","background: blue; padding:3px 0px; color: #fff;"),S("span",{"data-slate-node":"text",ref:o},[f.map((u,D)=>S(Ut,{isLast:s&&D===f.length-1,key:`${p.id}-${D}`,leaf:u,text:i,parent:a},null))])}}});function Gt(){return X(Ve)}function Xt(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!ct(t)}const Yt={decorations:Array,element:Object,selection:Object},Qt=R({name:"Element",props:Yt,setup(t){const e=W(),o=Q(),r=Gt();return $(()=>{const s=t.element,a=d.findKey(o,s),i=oe.get(o);e.value?(i==null||i.set(a,e.value),J.set(s,e.value),ne.set(e.value,s)):(i==null||i.delete(a),J.delete(s))}),()=>{const{decorations:s,element:a,selection:i}=t,f=o.isInline(a),p={"data-slate-node":"element",ref:e};if(f&&(p["data-slate-inline"]=!0),!f&&c.hasInlines(o,a)){const n=_.string(a),h=ve(n);h==="rtl"&&(p.dir=h)}let u,D;return c.isVoid(o,a)&&(p["data-slate-void"]=!0,!r&&f&&(p.contentEditable=!1),u=f?"span":"div",[[D]]=_.texts(a),ce.set(D,0),de.set(D,a)),console.info("%c Element Rerender ","background: yellow; padding:3px 0px; color: #000;"),S(en,{element:a,attributes:p},{default:()=>[c.isVoid(o,a)?r?null:S(u,{"data-slate-spacer":!0,style:{height:"0",color:"transparent",outline:"none",position:"absolute"}},{default:()=>[S(He,{decorations:[],isLast:!1,parent:a,text:D},null)]}):S(Ue,{decorations:s,node:a,selection:i},null)]})}}}),Zt={element:Object,attributes:Object},en=R({name:"DefaultElement",props:Zt,setup(t,{slots:e}){const o=Q();return()=>{let r;const{attributes:s,element:a}=t,i=o.isInline(a)?"span":"div";return S(i,Fe(s,{style:{position:"relative"}}),Xt(r=ee(e,"default"))?r:{default:()=>[r]})}}}),tn={decorations:Array,node:Object,selection:Object},Ue=R({name:"Children",props:tn,setup(t){return()=>{const e=$t(),o=Q(),{decorations:r,node:s,selection:a}=t,i=d.findPath(o,s),f=te.isElement(s)&&!o.isInline(s)&&c.hasInlines(o,s);return console.info("%c Children Rerender ","background: #ed143d7d; padding:3px 0px; color: #fff;"),S(le,null,[s.children.map((p,u)=>{const D=i.concat(u),n=s.children[u],h=d.findKey(o,n),b=c.range(o,D),g=a&&O.intersection(b,a),y=e([n,D]);for(const E of r){const C=O.intersection(E,b);C&&y.push(C)}return ce.set(n,u),de.set(n,s),te.isElement(n)?S(Qt,{decorations:y,element:n,key:h.id,selection:g},null):S(He,{decorations:y,key:h.id,isLast:f&&u===s.children.length-1,parent:s,text:n},null)})])}}}),nn={decorate:Function,onDOMBeforeInput:Function,placeholder:String,readOnly:Boolean,role:String,style:Object,scrollSelectionIntoView:Function,as:String,autofocus:Boolean,spellcheck:Boolean,autocapitalize:Boolean,autocorrect:Boolean},on=R({name:"Editable",props:nn,setup(t){var D;const e=jt(),[o,r]=we(!1),s=W(),a=W([]);ke([e,()=>t.readOnly],()=>{var n;Ne.set(e.value[0],(n=t.readOnly)!=null?n:!1)},{immediate:!0});const i={isComposing:!1,hasInsertPrefixInCompositon:!1,isDraggingInternally:!1,isUpdatingSelection:!1,latestElement:null};$(()=>{const{scrollSelectionIntoView:n=qe}=t,h=e.value[0];let b;s.value&&(b=ge(s.value))?(Be.set(h,b),fe.set(h,s.value),J.set(h,s.value),ne.set(s.value,h)):J.delete(h);const{selection:g}=h,E=d.findDocumentOrShadowRoot(h).getSelection();if(i.isComposing||!E||!d.isFocused(h))return;const C=E.type!=="None";if(!g&&!C)return;const x=fe.get(h);let N=!1;if(x.contains(E.anchorNode)&&x.contains(E.focusNode)&&(N=!0),C&&N&&g){const j=d.toSlateRange(h,E,{exactMatch:!0,suppressThrow:!0});if(j&&O.equals(j,g))return}if(g&&!d.hasRange(h,g)){h.selection=d.toSlateRange(h,E,{exactMatch:!1,suppressThrow:!1});return}i.isUpdatingSelection=!0;const v=g&&d.toDOMRange(h,g);v?(O.isBackward(g)?E.setBaseAndExtent(v.endContainer,v.endOffset,v.startContainer,v.startOffset):E.setBaseAndExtent(v.startContainer,v.startOffset,v.endContainer,v.endOffset),n(h,v)):E.removeAllRanges(),setTimeout(()=>{v&&he&&d.toDOMNode(h,h).focus(),i.isUpdatingSelection=!1})}),$(()=>{s.value&&t.autofocus&&s.value.focus()},[()=>t.autofocus]);const f=n=>{const{onDOMBeforeInput:h,readOnly:b=!1}=t,g=e.value[0];if(!b&&P(g,n.target)&&!rn(n,h)){const{selection:y}=g,{inputType:E}=n,C=n.dataTransfer||n.data||void 0;if(E==="insertCompositionText"||E==="deleteCompositionText")return;let x=!1;if(E==="insertText"&&y&&O.isCollapsed(y)&&n.data&&n.data.length===1&&/[a-z ]/i.test(n.data)&&y.anchor.offset!==0){x=!0,g.marks&&(x=!1);const{anchor:N}=y,v=c.above(g,{at:N,match:j=>c.isInline(g,j),mode:"highest"});if(v){const[,j]=v;c.isEnd(g,y.anchor,j)&&(x=!1)}}if(x||n.preventDefault(),!E.startsWith("delete")||E.startsWith("deleteBy")){const[N]=n.getTargetRanges();if(N){const v=d.toSlateRange(g,N,{exactMatch:!1,suppressThrow:!1});(!y||!O.equals(y,v))&&k.select(g,v)}}if(y&&O.isExpanded(y)&&E.startsWith("delete")){const N=E.endsWith("Backward")?"backward":"forward";c.deleteFragment(g,{direction:N});return}switch(E){case"deleteByComposition":case"deleteByCut":case"deleteByDrag":{c.deleteFragment(g);break}case"deleteContent":case"deleteContentForward":{c.deleteForward(g);break}case"deleteContentBackward":{c.deleteBackward(g);break}case"deleteEntireSoftLine":{c.deleteBackward(g,{unit:"line"}),c.deleteForward(g,{unit:"line"});break}case"deleteHardLineBackward":{c.deleteBackward(g,{unit:"block"});break}case"deleteSoftLineBackward":{c.deleteBackward(g,{unit:"line"});break}case"deleteHardLineForward":{c.deleteForward(g,{unit:"block"});break}case"deleteSoftLineForward":{c.deleteForward(g,{unit:"line"});break}case"deleteWordBackward":{c.deleteBackward(g,{unit:"word"});break}case"deleteWordForward":{c.deleteForward(g,{unit:"word"});break}case"insertLineBreak":case"insertParagraph":{c.insertBreak(g);break}case"insertFromComposition":case"insertFromDrop":case"insertFromPaste":case"insertFromYank":case"insertReplacementText":case"insertText":{E==="insertFromComposition"&&(i.isComposing&&r(!1),i.isComposing=!1);const N=d.getWindow(g);C instanceof N.DataTransfer?d.insertData(g,C):typeof C=="string"&&(x?a.value.push(()=>c.insertText(g,C)):c.insertText(g,C));break}}}};$(()=>(s.value&&z&&s.value.addEventListener("beforeinput",f),()=>{s.value&&z&&s.value.removeEventListener("beforeinput",f)}),[]);const p=dt(()=>{if(!i.isComposing&&!i.isUpdatingSelection&&!i.isDraggingInternally){const n=e.value[0],h=d.findDocumentOrShadowRoot(n),{activeElement:b}=h,g=d.toDOMNode(n,n),y=h.getSelection();if(b===g?(i.latestElement=b,H.set(n,!0)):H.delete(n),!y)return k.deselect(n);const{anchorNode:E,focusNode:C}=y,x=P(n,E)||Je(n,E),N=P(n,C)||Je(n,C);if(x&&N){const v=d.toSlateRange(n,y,{exactMatch:!1,suppressThrow:!1});k.select(n,v)}}},100),u=()=>setTimeout(p);return $(()=>{const n=d.getWindow(e.value[0]);return n.document.addEventListener("selectionchange",u),()=>{n.document.removeEventListener("selectionchange",u)}},[]),K(Ve,t.readOnly),K(je,(D=t.decorate)!=null?D:Ke),()=>{const n=e.value[0],{placeholder:h,decorate:b=Ke}=t,g=b([n,[]]);if(h&&n.children.length===1&&Array.from(_.texts(n)).length===1&&_.string(n)===""&&!o.value){const l=c.start(n,[]);g.push({[Me]:!0,placeholder:h,anchor:l,focus:l})}const ye=t,{readOnly:y=!1,onDOMBeforeInput:E,scrollSelectionIntoView:C=qe,style:x={},as:N="div",role:v="textbox",autocorrect:j,autocapitalize:Ye,spellcheck:Qe}=ye,T=se(ye,["readOnly","onDOMBeforeInput","scrollSelectionIntoView","style","as","role","autocorrect","autocapitalize","spellcheck"]),Ze=z?Qe:!1,et=z?j:"false",tt=z?Ye:"false";return console.info("%c Editable Rerender ","background: #40b3ec;  padding:3px 0px; color: #fff;"),S(N,Fe({"data-gramm":!1},T,{role:y?void 0:v,spellCheck:Ze,autoCorrect:et,autoCapitalize:tt,"data-slate-editor":!0,"data-slate-node":"value",contentEditable:!y,zindex:-1,suppressContentEditableWarning:!0,ref:s,style:re({position:"relative",outline:"none",whiteSpace:"pre-wrap",wordWrap:"break-word"},x),onBeforeInput:l=>{if(!z&&!y&&!L(l,T.onBeforeInput)&&P(n,l.target)&&(l.preventDefault(),!i.isComposing)){const w=l.data;c.insertText(n,w)}},onInput:()=>{for(const l of a.value)l();a.value=[]},onBlur:l=>{if(y||i.isUpdatingSelection||!P(n,l.target)||L(l,T.onBlur))return;const w=d.findDocumentOrShadowRoot(n);if(i.latestElement===w.activeElement)return;const{relatedTarget:m}=l,A=d.toDOMNode(n,n);if(m!==A&&!(V(m)&&m.hasAttribute("data-slate-spacer"))){if(m!=null&&U(m)&&d.hasDOMNode(n,m)){const M=d.toSlateNode(n,m);if(te.isElement(M)&&!n.isVoid(M))return}if(me){const M=w.getSelection();M==null||M.removeAllRanges()}H.delete(n)}},onClick:l=>{if(!y&&G(n,l.target)&&!L(l,T.onClick)&&U(l.target)){const w=d.toSlateNode(n,l.target),m=d.findPath(n,w);if(c.hasPath(n,m)&&_.get(n,m)===w){const M=c.start(n,m),I=c.end(n,m),be=c.void(n,{at:M}),Se=c.void(n,{at:I});if(be&&Se&&q.equals(be[1],Se[1])){const nt=c.range(n,M);k.select(n,nt)}}}},onCompositionEnd:l=>{if(P(n,l.target)&&!L(l,T.onCompositionEnd)&&(i.isComposing&&r(!1),i.isComposing=!1,!me&&!Tt&&!Bt&&!Lt&&l.data&&c.insertText(n,l.data),n.selection&&O.isCollapsed(n.selection))){const w=n.selection.anchor.path,m=_.leaf(n,w);i.hasInsertPrefixInCompositon&&(i.hasInsertPrefixInCompositon=!1,c.withoutNormalizing(n,()=>{const A=m.text.replace(/^\uFEFF/,"");k.delete(n,{distance:m.text.length,reverse:!0}),k.insertText(n,A)}))}},onCompositionUpdate:l=>{P(n,l.target)&&!L(l,T.onCompositionUpdate)&&(!i.isComposing&&r(!0),i.isComposing=!0)},onCompositionStart:l=>{if(P(n,l.target)&&!L(l,T.onCompositionStart)){const{selection:w,marks:m}=n;if(w){if(O.isExpanded(w)){c.deleteFragment(n);return}const A=c.above(n,{match:M=>c.isInline(n,M),mode:"highest"});if(A){const[,M]=A;if(c.isEnd(n,w.anchor,M)){const I=c.after(n,M);k.setSelection(n,{anchor:I,focus:I})}}m&&(i.hasInsertPrefixInCompositon=!0,k.insertNodes(n,re({text:"\uFEFF"},m),{select:!0}))}}},onCopy:l=>{P(n,l.target)&&!L(l,T.onCopy)&&(l.preventDefault(),l.clipboardData&&d.setFragmentData(n,l.clipboardData))},onCut:l=>{if(!y&&P(n,l.target)&&!L(l,T.onCut)){l.preventDefault(),l.clipboardData&&d.setFragmentData(n,l.clipboardData);const{selection:w}=n;if(w)if(O.isExpanded(w))c.deleteFragment(n);else{const m=_.parent(n,w.anchor.path);c.isVoid(n,m)&&k.delete(n)}}},onDragOver:l=>{if(G(n,l.target)&&!L(l,T.onDragOver)){const w=d.toSlateNode(n,l.target);c.isVoid(n,w)&&l.preventDefault()}},onDragStart:l=>{if(!y&&G(n,l.target)&&!L(l,T.onDragStart)){const w=d.toSlateNode(n,l.target),m=d.findPath(n,w);if(c.isVoid(n,w)||c.void(n,{at:m,voids:!0})){const M=c.range(n,m);k.select(n,M)}i.isDraggingInternally=!0,l.dataTransfer&&d.setFragmentData(n,l.dataTransfer)}},onDrop:l=>{if(!y&&G(n,l.target)&&!L(l,T.onDrop)){l.preventDefault();const w=n.selection,m=d.findEventRange(n,l),A=l.dataTransfer;k.select(n,m),i.isDraggingInternally&&(w&&k.delete(n,{at:w}),i.isDraggingInternally=!1),A&&d.insertData(n,A),d.isFocused(n)||d.focus(n)}},onDragEnd:l=>{!y&&i.isDraggingInternally&&G(n,l.target)&&!L(l,T.onDragEnd)&&(i.isDraggingInternally=!1)},onFocus:l=>{if(!y&&!i.isUpdatingSelection&&P(n,l.target)&&!L(l,T.onFocus)){const w=d.toDOMNode(n,n),m=d.findDocumentOrShadowRoot(n);if(i.latestElement=m.activeElement,he&&l.target!==w){w.focus();return}H.set(n,!0)}},onKeyDown:l=>{if(!y&&!i.isComposing&&P(n,l.target)&&!L(l,T.onKeyDown)){const w=l,{selection:m}=n,A=n.children[m!==null?m.focus.path[0]:0],M=ve(_.string(A))==="rtl";if(B.isRedo(w)){l.preventDefault();const I=n;typeof I.redo=="function"&&I.redo();return}if(B.isUndo(w)){l.preventDefault();const I=n;typeof I.undo=="function"&&I.undo();return}if(B.isMoveLineBackward(w)){l.preventDefault(),k.move(n,{unit:"line",reverse:!0});return}if(B.isMoveLineForward(w)){l.preventDefault(),k.move(n,{unit:"line"});return}if(B.isExtendLineBackward(w)){l.preventDefault(),k.move(n,{unit:"line",edge:"focus",reverse:!0});return}if(B.isExtendLineForward(w)){l.preventDefault(),k.move(n,{unit:"line",edge:"focus"});return}if(B.isMoveBackward(w)){l.preventDefault(),m&&O.isCollapsed(m)?k.move(n,{reverse:!M}):k.collapse(n,{edge:"start"});return}if(B.isMoveForward(w)){l.preventDefault(),m&&O.isCollapsed(m)?k.move(n,{reverse:M}):k.collapse(n,{edge:"end"});return}if(B.isMoveWordBackward(w)){l.preventDefault(),m&&O.isExpanded(m)&&k.collapse(n,{edge:"focus"}),k.move(n,{unit:"word",reverse:!M});return}if(B.isMoveWordForward(w)){l.preventDefault(),m&&O.isExpanded(m)&&k.collapse(n,{edge:"focus"}),k.move(n,{unit:"word",reverse:M});return}if(z){if((Pe||me)&&m&&(B.isDeleteBackward(w)||B.isDeleteForward(w))&&O.isCollapsed(m)){const I=_.parent(n,m.anchor.path);if(te.isElement(I)&&c.isVoid(n,I)&&c.isInline(n,I)){l.preventDefault(),c.deleteBackward(n,{unit:"block"});return}}}else{if(B.isBold(w)||B.isItalic(w)||B.isTransposeCharacter(w)){l.preventDefault();return}if(B.isSplitBlock(w)){l.preventDefault(),c.insertBreak(n);return}if(B.isDeleteBackward(w)){l.preventDefault(),m&&O.isExpanded(m)?c.deleteFragment(n,{direction:"backward"}):c.deleteBackward(n);return}if(B.isDeleteForward(w)){l.preventDefault(),m&&O.isExpanded(m)?c.deleteFragment(n,{direction:"forward"}):c.deleteForward(n);return}if(B.isDeleteLineBackward(w)){l.preventDefault(),m&&O.isExpanded(m)?c.deleteFragment(n,{direction:"backward"}):c.deleteBackward(n,{unit:"line"});return}if(B.isDeleteLineForward(w)){l.preventDefault(),m&&O.isExpanded(m)?c.deleteFragment(n,{direction:"forward"}):c.deleteForward(n,{unit:"line"});return}if(B.isDeleteWordBackward(w)){l.preventDefault(),m&&O.isExpanded(m)?c.deleteFragment(n,{direction:"backward"}):c.deleteBackward(n,{unit:"word"});return}if(B.isDeleteWordForward(w)){l.preventDefault(),m&&O.isExpanded(m)?c.deleteFragment(n,{direction:"forward"}):c.deleteForward(n,{unit:"word"});return}}}},onPaste:l=>{!y&&P(n,l.target)&&!L(l,T.onPaste)&&(!z||xt(l))&&(l.preventDefault(),l.clipboardData&&d.insertData(n,l.clipboardData))}}),{default:()=>[S(Ue,{decorations:g,node:n,selection:n.selection},null)]})}}}),Ke=()=>[],an=R({props:{attributes:Object},render(){return S("span",this.$props.attributes,[ee(this.$slots,"default")])}}),qe=(t,e)=>{const o=e.startContainer.parentElement;o.getBoundingClientRect=e.getBoundingClientRect.bind(e),ft(o,{scrollMode:"if-needed"}),delete o.getBoundingClientRect},P=(t,e)=>U(e)&&d.hasDOMNode(t,e,{editable:!0}),rn=(t,e)=>{if(!e)return!1;const o=e(t);return o!=null?o:t.defaultPrevented},G=(t,e)=>U(e)&&d.hasDOMNode(t,e),Je=(t,e)=>{const o=G(t,e)&&d.toSlateNode(t,e);return c.isVoid(t,o)},L=(t,e)=>{if(!e)return!1;const o=e(t);return o!=null?o:t.defaultPrevented},Ge=(t,e)=>{const o=(e.top+e.bottom)/2;return t.top<=o&&t.bottom>=o},Xe=(t,e,o)=>{const r=d.toDOMRange(t,e).getBoundingClientRect(),s=d.toDOMRange(t,o).getBoundingClientRect();return Ge(r,s)&&Ge(s,r)},sn=(t,e)=>{const o=c.range(t,O.end(e)),r=Array.from(c.positions(t,{at:e}));let s=0,a=r.length,i=Math.floor(a/2);if(Xe(t,c.range(t,r[s]),o))return c.range(t,r[s],o);if(r.length<2)return c.range(t,r[r.length-1],o);for(;i!==r.length&&i!==s;)Xe(t,c.range(t,r[i]),o)?a=i:s=i,i=Math.floor((s+a)/2);return c.range(t,r[a],o)},ln=t=>{const e=t,{apply:o,onChange:r,deleteBackward:s}=e;return oe.set(e,new WeakMap),e.deleteBackward=a=>{if(a!=="line")return s(a);if(t.selection&&O.isCollapsed(t.selection)){const i=c.above(t,{match:f=>c.isBlock(t,f),at:t.selection});if(i){const[,f]=i,p=c.range(t,f,t.selection.anchor),u=sn(e,p);O.isCollapsed(u)||k.delete(t,{at:u})}}},e.apply=a=>{const i=[];switch(a.type){case"insert_text":case"remove_text":case"set_node":{for(const[f,p]of c.levels(e,{at:a.path})){const u=d.findKey(e,f);i.push([p,u])}break}case"insert_node":case"remove_node":case"merge_node":case"split_node":{for(const[f,p]of c.levels(e,{at:q.parent(a.path)})){const u=d.findKey(e,f);i.push([p,u])}break}case"move_node":{for(const[f,p]of c.levels(e,{at:q.common(q.parent(a.path),q.parent(a.newPath))})){const u=d.findKey(e,f);i.push([p,u])}break}}o(a);for(const[f,p]of i){const[u]=c.node(e,f);ue.set(u,p)}},e.setFragmentData=a=>{const{selection:i}=e;if(!i)return;const[f,p]=O.edges(i),u=c.void(e,{at:f.path}),D=c.void(e,{at:p.path});if(O.isCollapsed(i)&&!u)return;const n=d.toDOMRange(e,i);let h=n.cloneContents(),b=h.childNodes[0];if(h.childNodes.forEach(x=>{x.textContent&&x.textContent.trim()!==""&&(b=x)}),D){const[x]=D,N=n.cloneRange(),v=d.toDOMNode(e,x);N.setEndAfter(v),h=N.cloneContents()}if(u&&(b=h.querySelector("[data-slate-spacer]")),Array.from(h.querySelectorAll("[data-slate-zero-width]")).forEach(x=>{const N=x.getAttribute("data-slate-zero-width")==="n";x.textContent=N?`
`:""}),Le(b)){const x=document.createElement("span");x.style.whiteSpace="pre",x.appendChild(b),h.appendChild(x),b=x}const g=e.getFragment(),y=JSON.stringify(g),E=window.btoa(encodeURIComponent(y));b.setAttribute("data-slate-fragment",E),a.setData("application/x-slate-fragment",E);const C=document.createElement("div");return C.appendChild(h),C.setAttribute("hidden","true"),document.body.appendChild(C),a.setData("text/html",C.innerHTML),a.setData("text/plain",Re(C)),document.body.removeChild(C),a},e.insertData=a=>{e.insertFragmentData(a),e.insertTextData(a)},e.insertFragmentData=a=>{const i=a.getData("application/x-slate-fragment")||Ft(a);if(i){const f=decodeURIComponent(window.atob(i)),p=JSON.parse(f);e.insertFragment(p);return}},e.insertTextData=a=>{const i=a.getData("text/plain");if(i){const f=i.split(/\r\n|\r|\n/);let p=!1;for(const u of f)p&&k.splitNodes(e,{always:!0}),e.insertText(u),p=!0}},e.onChange=()=>{var a;(a=pe.get(e))==null||a(),r()},e};ut(!1);var cn={setup(){const t=ht({count:0,o:{count:0},readOnly:!1,autofocus:!0}),e=ln(mt());let o=W([{type:"paragraph",children:[{text:"This is editable plain text, just like a <textarea>!"}]}]);const r=a=>{var i,f;console.log("app",wt((f=(i=a[0])==null?void 0:i.children)==null?void 0:f[0].text)),o.value=a},s=W(0);return K("o",s),()=>S(le,null,[S(Pt,{editor:e,value:o.value,onChange:r},{default:()=>[S(on,{placeholder:"Typo anything...",readOnly:t.readOnly,autofocus:t.autofocus},null)]}),S("p",null,null),S(dn,{onChange:()=>{t.readOnly=!t.readOnly},title:"readOnly",flag:t.readOnly},null)])}};const dn=R({props:{flag:Boolean,onChange:Function,title:String},setup(t){return()=>{const e=`${pt.exports.random()}`;return S("span",null,[S("input",{type:"checkbox",id:e,checked:t.flag,onChange:t.onChange},null),S("label",{for:e},[t.title])])}}});R({setup(t){const e=X("o"),o=W(0);return Ce(()=>{console.log(o.value)}),()=>(console.log("children rerender",e),S("p",{onClick:()=>o.value+=1},[gt("props: "),e.value]))}});Dt(cn).mount("#app");
